nest_update_eta:
  alias: Nest Update ETA
  sequence:
    - service: nest.set_eta
      data_template:
        eta: >
          {% if is_state_attr('proximity.home', 'nearest', 'Dennis') %}
            {{ ((( states.sensor.dennis_to_home.state | int) * 60) - 3600) | timestamp_custom('%H:%M:%S') }}
          {% elif is_state_attr('proximity.home', 'nearest', 'Dennis, Stephanie') %}
            {{ ((( states.sensor.dennis_to_home.state | int) * 60) - 3600) | timestamp_custom('%H:%M:%S') }}
          {% elif is_state_attr('proximity.home', 'nearest', 'Stephanie') %}
            {{ ((( states.sensor.stephanie_to_home.state | int) * 60) - 3600) | timestamp_custom('%H:%M:%S') }}
          {% endif %}
        eta_window: 00:01
        trip_id: ETA set by HAS
        structure:
          - Retsinagaard