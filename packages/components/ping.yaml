binary_sensor:
  - platform: ping
    host: 8.8.8.8
    name: "Ping Google 1"
  - platform: ping
    host: 8.8.4.4
    name: "Ping Google 2"
  - platform: template
    sensors:
      internet_connection:
        device_class: connectivity
        value_template: >-
          {{ is_state('binary_sensor.ping_google_1', 'on')
             or is_state('binary_sensor.ping_google_2', 'on') }}
        friendly_name: "Internet connection"

automation:
  - id: d9541445-0fbb-4809-aa34-7b0e52945137
    alias: '[Switch] Restart Ziggo Router when internet outage'
    trigger:
      - platform: time_pattern
        minutes: "/30"
    condition:
      - condition: state
        entity_id: binary_sensor.internet_connection
        state: "off"
        for:
          minutes: 10
    action:
      - service: switch.turn_off
        entity_id: switch.ziggo_router
      - delay: 1:00
      - service: switch.turn_on
        entity_id: switch.ziggo_router

  - id: 21640b6b-8bc9-40e2-ba34-1da182425de0
    alias: Internet is up again
    trigger:
      - platform: state
        entity_id: binary_sensor.internet_connection
        from: "off"
        to: "on"
    action:
        - service: notify.mobile_app_sm_g986b
          data:
            message: Internet is up again
            data:
              channel: Alert
              tag: alert
        - service: notify.mobile_app_iphone_van_stephanie
          data:
            message: Internet is up again
            data:
              push:
                thread-id: "alert"
                presentation_options:
                  - alert
                  - badge
        - service: notify.mobile_app_iphone_van_emilie
          data:
            message: Internet is up again
            data:
              push:
                thread-id: "alert"
                presentation_options:
                  - alert
                  - badge                  